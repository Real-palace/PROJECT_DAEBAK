@model IEnumerable<daebak_subdivision_website.Models.Facility>
@{
    ViewData["Title"] = "Manage Facilities";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<!-- Display Error Message if any -->
@if (TempData["ErrorMessage"] != null)
{
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        <span class="block sm:inline">@TempData["ErrorMessage"]</span>
        <button class="absolute top-0 bottom-0 right-0 px-4 py-3" onclick="this.parentElement.style.display='none';">
            <span class="ph ph-x"></span>
        </button>
    </div>
    
    <!-- Clear the TempData so it doesn't appear on other pages -->
    TempData.Remove("ErrorMessage");
}

<!-- Page Header -->
<div class="bg-white rounded-xl shadow-sm p-6 mb-6">
    <div class="flex items-center">
        <div class="flex-shrink-0 mr-4">
            <div class="bg-primary/10 p-3 rounded-full">
                <i class="ph ph-buildings text-3xl text-primary"></i>
            </div>
        </div>
        <div>
            <h2 class="text-xl font-semibold text-gray-800">Facility Management</h2>
            <p class="text-gray-600 mt-1">Manage subdivision facilities and track reservations</p>
        </div>
    </div>
</div>

<!-- Tab Navigation -->
<div class="flex border-b border-gray-200 mb-6">
    <button id="tab-btn-facilities" class="tab-btn active px-6 py-3 border-b-2 border-primary font-medium text-primary">
        Facilities
    </button>
    <button id="tab-btn-reservations" class="tab-btn px-6 py-3 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
        Reservations
    </button>
    <button id="tab-btn-calendar" class="tab-btn px-6 py-3 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
        Calendar
    </button>
</div>

<!-- Facilities Section -->
<div id="tab-facilities" class="tab-content">
    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-lg font-medium text-gray-900">Subdivision Facilities</h3>
            <button id="add-facility-btn" class="px-4 py-2 bg-secondary text-white rounded-lg hover:bg-secondary/90 transition-colors flex items-center space-x-1">
                <i class="ph ph-plus"></i>
                <span>Add Facility</span>
            </button>
        </div>

        <!-- Facility Cards Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- These cards will be populated from the database -->
            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/clubhouse.jpg" alt="Clubhouse" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Clubhouse</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="1">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="1">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Perfect for parties and gatherings</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Main Avenue, Community Center</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Available</span>
                        <span class="text-sm text-gray-600">Capacity: 50</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/swimming_pool.jpg" alt="Swimming Pool" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Swimming Pool</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="2">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="2">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Olympic-sized pool with lanes</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Recreational Zone, Block C</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Available</span>
                        <span class="text-sm text-gray-600">Capacity: 30</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/basketball_court.jpg" alt="Basketball Court" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Basketball Court</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="3">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="3">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Full-sized court with lighting</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Sports Complex, East Wing</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Available</span>
                        <span class="text-sm text-gray-600">Capacity: 20</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/gameroom.jpg" alt="Game Room" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Game Room</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="4">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="4">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Billiards, ping pong, and board games</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Community Center, 2nd Floor</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Available</span>
                        <span class="text-sm text-gray-600">Capacity: 15</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/gym.jpg" alt="Gym & Fitness Center" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Gym & Fitness Center</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="5">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="5">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Modern equipment for cardio and strength training</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Health Plaza, Block A</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-yellow-100 text-yellow-700 px-2 py-1 rounded">Under Maintenance</span>
                        <span class="text-sm text-gray-600">Capacity: 25</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100">
                <img src="~/images/multipurpose_hall.jpg" alt="Multi-purpose Hall" class="w-full h-40 object-cover">
                <div class="p-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-semibold text-lg">Multi-Purpose Hall</h3>
                        <div class="flex space-x-1">
                            <button class="edit-facility-btn p-1 text-blue-600 hover:text-blue-800" data-id="6">
                                <i class="ph ph-pencil-simple"></i>
                            </button>
                            <button class="delete-facility-btn p-1 text-red-600 hover:text-red-800" data-id="6">
                                <i class="ph ph-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm">Flexible space for events and activities</p>
                    <div class="flex items-center mt-2 text-xs text-gray-500">
                        <i class="ph ph-map-pin mr-1"></i>
                        <span>Events Center, West Entrance</span>
                    </div>
                    <div class="mt-3 flex items-center justify-between">
                        <span class="text-sm font-medium bg-green-100 text-green-700 px-2 py-1 rounded">Available</span>
                        <span class="text-sm text-gray-600">Capacity: 100</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Reservations Section -->
<div id="tab-reservations" class="tab-content hidden">
    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-lg font-medium text-gray-900">Facility Reservations</h3>
            
            <!-- Filter Controls -->
            <div class="flex space-x-3">
                <div class="relative">
                    <input type="text" id="reservation-search" placeholder="Search by name..." class="pl-8 pr-4 py-1.5 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                    <i class="ph ph-magnifying-glass absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
                <select id="status-filter" class="px-3 py-1.5 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                    <option value="all">All Statuses</option>
                    <option value="Pending">Pending</option>
                    <option value="Confirmed">Confirmed</option>
                    <option value="Completed">Completed</option>
                    <option value="Cancelled">Cancelled</option>
                </select>
                <select id="facility-filter" class="px-3 py-1.5 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                    <option value="all">All Facilities</option>
                    <option value="1">Clubhouse</option>
                    <option value="2">Swimming Pool</option>
                    <option value="3">Basketball Court</option>
                    <option value="4">Game Room</option>
                    <option value="5">Gym & Fitness Center</option>
                    <option value="6">Multi-Purpose Hall</option>
                </select>
            </div>
        </div>

        <!-- Reservations Table -->
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reservation ID</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Homeowner</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Facility</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Start Date & Time</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">End Date & Time</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <!-- Pending Reservation -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RES-23051</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">Sofia Garcia</div>
                            <div class="text-xs text-gray-500">House #105</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Clubhouse</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 15, 2025 • 2:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 15, 2025 • 6:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button class="approve-btn text-green-600 hover:text-green-800" data-id="RES-23051">
                                    <i class="ph ph-check-circle"></i>
                                </button>
                                <button class="reject-btn text-red-600 hover:text-red-800" data-id="RES-23051">
                                    <i class="ph ph-x-circle"></i>
                                </button>
                                <button class="view-btn text-blue-600 hover:text-blue-800" data-id="RES-23051">
                                    <i class="ph ph-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <!-- Confirmed Reservation -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RES-23048</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">John Smith</div>
                            <div class="text-xs text-gray-500">House #211</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Basketball Court</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 10, 2025 • 4:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 10, 2025 • 6:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Confirmed</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button class="complete-btn text-blue-600 hover:text-blue-800" data-id="RES-23048">
                                    <i class="ph ph-check-square"></i>
                                </button>
                                <button class="cancel-btn text-red-600 hover:text-red-800" data-id="RES-23048">
                                    <i class="ph ph-x-square"></i>
                                </button>
                                <button class="view-btn text-blue-600 hover:text-blue-800" data-id="RES-23048">
                                    <i class="ph ph-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- Completed Reservation -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RES-23042</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">Maria Rodriguez</div>
                            <div class="text-xs text-gray-500">House #137</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Swimming Pool</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 3, 2025 • 10:00 AM</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 3, 2025 • 12:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">Completed</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button class="view-btn text-blue-600 hover:text-blue-800" data-id="RES-23042">
                                    <i class="ph ph-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- Cancelled Reservation -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">RES-23039</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">James Wilson</div>
                            <div class="text-xs text-gray-500">House #185</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Multi-Purpose Hall</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 1, 2025 • 3:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">May 1, 2025 • 5:00 PM</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Cancelled</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <div class="flex space-x-2">
                                <button class="view-btn text-blue-600 hover:text-blue-800" data-id="RES-23039">
                                    <i class="ph ph-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Pagination -->
        <div class="mt-4 flex items-center justify-between">
            <div class="text-sm text-gray-500">
                Showing <span id="showing-start">1</span> to <span id="showing-end">4</span> of <span id="total-reservations">4</span> reservations
            </div>
            <div class="flex items-center space-x-2">
                <button id="prev-page" class="px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50" disabled>
                    <i class="ph ph-caret-left"></i>
                </button>
                <span class="text-sm text-gray-700">Page <span id="current-page">1</span> of <span id="total-pages">1</span></span>
                <button id="next-page" class="px-3 py-1 border border-gray-300 rounded-md disabled:opacity-50" disabled>
                    <i class="ph ph-caret-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Calendar Section -->
<div id="tab-calendar" class="tab-content hidden">
    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-lg font-medium text-gray-900">Facility Booking Calendar</h3>
            <div class="flex space-x-3">
                <select id="calendar-facility-filter" class="px-3 py-1.5 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50">
                    <option value="all">All Facilities</option>
                    <option value="1">Clubhouse</option>
                    <option value="2">Swimming Pool</option>
                    <option value="3">Basketball Court</option>
                    <option value="4">Game Room</option>
                    <option value="5">Gym & Fitness Center</option>
                    <option value="6">Multi-Purpose Hall</option>
                </select>
            </div>
        </div>
        
        <!-- Calendar Display -->
        <div id="facility-calendar" class="min-h-[600px]"></div>
    </div>
    
    <!-- Statistics -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white rounded-xl shadow-md p-6">
            <h4 class="text-md font-medium text-gray-900 mb-3">Most Popular Facility</h4>
            <div class="flex items-center">
                <div class="bg-blue-100 p-2 rounded-lg mr-3">
                    <i class="ph ph-swimming-pool text-blue-600 text-xl"></i>
                </div>
                <div>
                    <p class="text-lg font-semibold text-gray-800">Swimming Pool</p>
                    <p class="text-sm text-gray-500">45 bookings this month</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-md p-6">
            <h4 class="text-md font-medium text-gray-900 mb-3">Busiest Day</h4>
            <div class="flex items-center">
                <div class="bg-green-100 p-2 rounded-lg mr-3">
                    <i class="ph ph-calendar text-green-600 text-xl"></i>
                </div>
                <div>
                    <p class="text-lg font-semibold text-gray-800">Saturday</p>
                    <p class="text-sm text-gray-500">62% of weekly bookings</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-md p-6">
            <h4 class="text-md font-medium text-gray-900 mb-3">Average Booking Duration</h4>
            <div class="flex items-center">
                <div class="bg-purple-100 p-2 rounded-lg mr-3">
                    <i class="ph ph-hourglass text-purple-600 text-xl"></i>
                </div>
                <div>
                    <p class="text-lg font-semibold text-gray-800">2.5 hours</p>
                    <p class="text-sm text-gray-500">Per reservation</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add/Edit Facility Modal -->
<div id="facility-modal" class="fixed inset-0 bg-gray-900/50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-lg mx-4 overflow-hidden">
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
            <h3 id="facility-modal-title" class="text-lg font-medium text-gray-900">Add New Facility</h3>
            <button id="close-facility-modal" class="text-gray-400 hover:text-gray-500">
                <i class="ph ph-x text-xl"></i>
            </button>
        </div>
        <form id="facility-form">
            <div class="p-6 space-y-4">
                <input type="hidden" id="facility-id" value="">
                
                <div>
                    <label for="facility-name" class="block text-sm font-medium text-gray-700 mb-1">Facility Name*</label>
                    <input type="text" id="facility-name" name="NAME" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                </div>
                
                <div>
                    <label for="facility-description" class="block text-sm font-medium text-gray-700 mb-1">Description*</label>
                    <textarea id="facility-description" name="DESCRIPTION" rows="2" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" required></textarea>
                </div>
                
                <div>
                    <label for="facility-location" class="block text-sm font-medium text-gray-700 mb-1">Location*</label>
                    <input type="text" id="facility-location" name="LOCATION" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                </div>
                
                <div>
                    <label for="facility-capacity" class="block text-sm font-medium text-gray-700 mb-1">Capacity*</label>
                    <input type="number" id="facility-capacity" name="CAPACITY" min="1" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                </div>
                
                <div>
                    <label for="facility-status" class="block text-sm font-medium text-gray-700 mb-1">Status*</label>
                    <select id="facility-status" name="IS_AVAILABLE" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                        <option value="1">Available</option>
                        <option value="0">Under Maintenance</option>
                    </select>
                </div>
                
                <div>
                    <label for="facility-image" class="block text-sm font-medium text-gray-700 mb-1">Image</label>
                    <div class="flex items-center">
                        <input type="text" id="facility-image" name="IMAGE" class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="e.g. /images/clubhouse.jpg">
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 p-4 flex justify-end space-x-3">
                <button type="button" id="cancel-facility-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    Cancel
                </button>
                <button type="submit" id="save-facility-btn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/80">
                    Save
                </button>
            </div>
        </form>
    </div>
</div>

<!-- View Reservation Modal -->
<div id="reservation-modal" class="fixed inset-0 bg-gray-900/50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-lg mx-4 overflow-hidden">
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
            <h3 id="reservation-modal-title" class="text-lg font-medium text-gray-900">Reservation Details</h3>
            <button id="close-reservation-modal" class="text-gray-400 hover:text-gray-500">
                <i class="ph ph-x text-xl"></i>
            </button>
        </div>
        <div class="p-6">
            <div class="mb-6">
                <div class="mb-2">
                    <span id="reservation-id" class="text-sm font-medium bg-gray-100 text-gray-800 px-2 py-1 rounded">RES-23051</span>
                    <span id="reservation-status" class="text-sm font-medium bg-yellow-100 text-yellow-800 px-2 py-1 rounded ml-2">Pending</span>
                </div>
                <h3 id="reservation-facility" class="text-xl font-semibold text-gray-900">Clubhouse</h3>
            </div>
            
            <div class="grid grid-cols-2 gap-y-4 mb-6">
                <div>
                    <p class="text-sm text-gray-500">Homeowner</p>
                    <p id="reservation-homeowner" class="font-medium">Sofia Garcia (House #105)</p>
                </div>
                
                <div>
                    <p class="text-sm text-gray-500">Contact</p>
                    <p id="reservation-contact" class="font-medium">0999-123-4567</p>
                </div>
                
                <div>
                    <p class="text-sm text-gray-500">Start Date & Time</p>
                    <p id="reservation-start" class="font-medium">May 15, 2025 • 2:00 PM</p>
                </div>
                
                <div>
                    <p class="text-sm text-gray-500">End Date & Time</p>
                    <p id="reservation-end" class="font-medium">May 15, 2025 • 6:00 PM</p>
                </div>
                
                <div>
                    <p class="text-sm text-gray-500">Reservation Made</p>
                    <p id="reservation-created" class="font-medium">May 1, 2025 • 10:23 AM</p>
                </div>
                
                <div>
                    <p class="text-sm text-gray-500">Last Updated</p>
                    <p id="reservation-updated" class="font-medium">May 1, 2025 • 10:23 AM</p>
                </div>
            </div>
            
            <div class="mb-6">
                <p class="text-sm text-gray-500 mb-1">Notes</p>
                <p id="reservation-notes" class="text-sm bg-gray-50 p-3 rounded-lg">Birthday celebration for 25 people. Will need tables and chairs.</p>
            </div>
            
            <div id="pending-actions" class="flex justify-end space-x-3 border-t border-gray-200 pt-4 mt-4">
                <button id="reject-reservation" class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200">
                    Reject
                </button>
                <button id="approve-reservation" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                    Approve
                </button>
            </div>
            
            <div id="confirmed-actions" class="flex justify-end space-x-3 border-t border-gray-200 pt-4 mt-4 hidden">
                <button id="cancel-reservation" class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200">
                    Cancel
                </button>
                <button id="complete-reservation" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    Mark as Completed
                </button>
            </div>
            
            <div id="completed-actions" class="flex justify-end space-x-3 border-t border-gray-200 pt-4 mt-4 hidden">
                <button id="close-details" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-facility-modal" class="fixed inset-0 bg-gray-900/50 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-md mx-4 overflow-hidden">
        <div class="p-6">
            <div class="flex items-center justify-center mb-4">
                <div class="bg-red-100 rounded-full p-3">
                    <i class="ph ph-warning text-3xl text-red-600"></i>
                </div>
            </div>
            <h3 class="text-lg font-medium text-gray-900 text-center mb-2">Delete Facility</h3>
            <p class="text-gray-500 text-center mb-6">Are you sure you want to delete this facility? This will also remove all future reservations for this facility.</p>
            
            <div class="flex justify-center space-x-3">
                <button id="cancel-delete-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    Cancel
                </button>
                <button id="confirm-delete-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                    Delete
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <!-- Include FullCalendar -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab switching
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    tabBtns.forEach(b => {
                        b.classList.remove('active');
                        b.classList.remove('border-primary');
                        b.classList.remove('text-primary');
                        b.classList.add('border-transparent');
                        b.classList.add('text-gray-500');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    this.classList.add('border-primary');
                    this.classList.add('text-primary');
                    this.classList.remove('border-transparent');
                    this.classList.remove('text-gray-500');
                    
                    // Hide all tab contents
                    tabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    // Show the corresponding tab content
                    const tabId = this.id.replace('tab-btn-', 'tab-');
                    document.getElementById(tabId).classList.remove('hidden');
                    
                    // Initialize calendar when switching to that tab
                    if (tabId === 'tab-calendar' && !calendarInitialized) {
                        initializeCalendar();
                        calendarInitialized = true;
                    }
                });
            });
            
            // Modal handling functions
            function openModal(modalId) {
                document.getElementById(modalId).classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
            }
            
            function closeModal(modalId) {
                document.getElementById(modalId).classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }
            
            // Facility Modal
            const addFacilityBtn = document.getElementById('add-facility-btn');
            const closeFacilityModalBtn = document.getElementById('close-facility-modal');
            const cancelFacilityBtn = document.getElementById('cancel-facility-btn');
            const facilityForm = document.getElementById('facility-form');
            
            addFacilityBtn.addEventListener('click', function() {
                document.getElementById('facility-modal-title').textContent = 'Add New Facility';
                document.getElementById('facility-id').value = '';
                facilityForm.reset();
                openModal('facility-modal');
            });
            
            closeFacilityModalBtn.addEventListener('click', function() {
                closeModal('facility-modal');
            });
            
            cancelFacilityBtn.addEventListener('click', function() {
                closeModal('facility-modal');
            });
            
            // Edit Facility
            document.querySelectorAll('.edit-facility-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const facilityId = this.dataset.id;
                    document.getElementById('facility-modal-title').textContent = 'Edit Facility';
                    document.getElementById('facility-id').value = facilityId;
                    
                    // In a real application, you would fetch the facility data from the server
                    // and populate the form fields
                    // For now, let's use dummy data based on the facility card
                    const card = this.closest('.rounded-xl');
                    document.getElementById('facility-name').value = card.querySelector('h3').textContent;
                    document.getElementById('facility-description').value = card.querySelector('p').textContent;
                    document.getElementById('facility-location').value = card.querySelector('.ph-map-pin').nextElementSibling.textContent;
                    document.getElementById('facility-capacity').value = card.querySelector('.text-sm.text-gray-600').textContent.replace('Capacity: ', '');
                    
                    const statusBadge = card.querySelector('.text-sm.font-medium');
                    document.getElementById('facility-status').value = statusBadge.textContent === 'Available' ? '1' : '0';
                    
                    const imgSrc = card.querySelector('img').src;
                    document.getElementById('facility-image').value = imgSrc.substring(imgSrc.lastIndexOf('/'));
                    
                    openModal('facility-modal');
                });
            });
            
            // Delete Facility
            document.querySelectorAll('.delete-facility-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const facilityId = this.dataset.id;
                    document.getElementById('confirm-delete-btn').dataset.id = facilityId;
                    openModal('delete-facility-modal');
                });
            });
            
            document.getElementById('cancel-delete-btn').addEventListener('click', function() {
                closeModal('delete-facility-modal');
            });
            
            document.getElementById('confirm-delete-btn').addEventListener('click', function() {
                // In a real application, you would send a request to delete the facility
                // For now, let's just close the modal
                closeModal('delete-facility-modal');
                alert('Facility deleted successfully!');
            });
            
            // View Reservation
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reservationId = this.dataset.id;
                    document.getElementById('reservation-id').textContent = reservationId;
                    
                    // Find the row containing this reservation
                    const row = this.closest('tr');
                    
                    // Update reservation modal with data from the row
                    const status = row.querySelector('.rounded-full').textContent.trim();
                    document.getElementById('reservation-status').textContent = status;
                    document.getElementById('reservation-status').className = row.querySelector('.rounded-full').className;
                    
                    document.getElementById('reservation-facility').textContent = row.querySelector('td:nth-child(3)').textContent.trim();
                    document.getElementById('reservation-homeowner').textContent = 
                        row.querySelector('td:nth-child(2) div:first-child').textContent.trim() + 
                        ' (' + row.querySelector('td:nth-child(2) div:last-child').textContent.trim() + ')';
                    document.getElementById('reservation-start').textContent = row.querySelector('td:nth-child(4)').textContent.trim();
                    document.getElementById('reservation-end').textContent = row.querySelector('td:nth-child(5)').textContent.trim();
                    
                    // Show/hide appropriate action buttons based on status
                    document.getElementById('pending-actions').classList.add('hidden');
                    document.getElementById('confirmed-actions').classList.add('hidden');
                    document.getElementById('completed-actions').classList.add('hidden');
                    
                    if (status === 'Pending') {
                        document.getElementById('pending-actions').classList.remove('hidden');
                    } else if (status === 'Confirmed') {
                        document.getElementById('confirmed-actions').classList.remove('hidden');
                    } else {
                        document.getElementById('completed-actions').classList.remove('hidden');
                    }
                    
                    openModal('reservation-modal');
                });
            });
            
            document.getElementById('close-reservation-modal').addEventListener('click', function() {
                closeModal('reservation-modal');
            });
            
            document.getElementById('close-details').addEventListener('click', function() {
                closeModal('reservation-modal');
            });
            
            // Approve/Reject/Cancel/Complete Reservation
            document.querySelectorAll('.approve-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reservationId = this.dataset.id;
                    // In a real application, you would send a request to approve the reservation
                    alert(`Reservation ${reservationId} approved successfully!`);
                });
            });
            
            document.querySelectorAll('.reject-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reservationId = this.dataset.id;
                    // In a real application, you would send a request to reject the reservation
                    alert(`Reservation ${reservationId} rejected.`);
                });
            });
            
            document.querySelectorAll('.cancel-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reservationId = this.dataset.id;
                    // In a real application, you would send a request to cancel the reservation
                    alert(`Reservation ${reservationId} cancelled.`);
                });
            });
            
            document.querySelectorAll('.complete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reservationId = this.dataset.id;
                    // In a real application, you would send a request to mark the reservation as completed
                    alert(`Reservation ${reservationId} marked as completed.`);
                });
            });
            
            // Initialize Calendar
            let calendarInitialized = false;
            
            function initializeCalendar() {
                var calendarEl = document.getElementById('facility-calendar');
                
                // Sample reservation data - would be loaded from the server in production
                var reservations = [
                    { 
                        title: 'Clubhouse - Sofia Garcia', 
                        start: '2025-05-15T14:00:00', 
                        end: '2025-05-15T18:00:00', 
                        color: '#FFA07A',
                        extendedProps: {
                            status: 'pending',
                            facility: 'Clubhouse',
                            homeowner: 'Sofia Garcia'
                        }
                    },
                    { 
                        title: 'Basketball Court - John Smith', 
                        start: '2025-05-10T16:00:00', 
                        end: '2025-05-10T18:00:00', 
                        color: '#90EE90',
                        extendedProps: {
                            status: 'confirmed',
                            facility: 'Basketball Court',
                            homeowner: 'John Smith'
                        }
                    },
                    { 
                        title: 'Swimming Pool - Maria Rodriguez', 
                        start: '2025-05-03T10:00:00', 
                        end: '2025-05-03T12:00:00', 
                        color: '#B0C4DE',
                        extendedProps: {
                            status: 'completed',
                            facility: 'Swimming Pool',
                            homeowner: 'Maria Rodriguez'
                        }
                    },
                    { 
                        title: 'Multi-Purpose Hall - James Wilson', 
                        start: '2025-05-01T15:00:00', 
                        end: '2025-05-01T17:00:00', 
                        color: '#FFB6C1',
                        extendedProps: {
                            status: 'cancelled',
                            facility: 'Multi-Purpose Hall',
                            homeowner: 'James Wilson'
                        }
                    }
                ];
                
                var calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    initialDate: '2025-05-04',
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    events: reservations,
                    eventClick: function(info) {
                        // In a real application, you would fetch the reservation details from the server
                        // For now, let's just show an alert
                        alert(`Reservation: ${info.event.title}\nStatus: ${info.event.extendedProps.status}`);
                    },
                    eventTimeFormat: {
                        hour: 'numeric',
                        minute: '2-digit',
                        meridiem: 'short'
                    }
                });
                
                calendar.render();
            }
        });
    </script>
}